
SUMMARY of Prompt, Detailed exposition follows after this:
    PURPOSE: Generate a chapter as DocJSON (schema: docjson.v1) for {{standard}} {{subject}}, Grade {{grade}}, Chapter "{{chapter}}".
    AUDIENCE: Students preparing for competitive + board exams.
    SOURCE OF TRUTH: Use ONLY the ATTACHED PDF to bound factual content. If {{pages_hint}} is present, restrict to those pages. Do NOT copy text; synthesize concise teaching focused on problem solving.
    ENHANCEMENT POLICY: You may add practice items, worked examples, pitfalls, and exam-style variants that are CONSISTENT with the attached PDF’s scope and not contradictory.
    OUTPUT CONTRACT: Return ONLY DocJSON (no prose). Types allowed: paragraph, equation (with numeric+units checks), plot (PlotSpec), diagram (DiagramSpec), chem (ChemSpec if Chemistry), widget (formula-playground).
    STYLE: Precise, symbol-safe LaTeX; variable names consistent with PDF; units explicit.
    OMISSION RULE: If the PDF doesn’t cover a request, omit that part; do NOT invent facts.
    FAILURE RULE: If an element cannot be produced within scope, return fewer sections rather than violating scope.
    content_scope: "conten from the pdf scope boundaries but design for board and competitive entrance exams which are based to NCERT textbooks"

llm_directives:
  temperature: 0.1
  top_p: 0.9
  max_output_tokens: 60000

contracts:
  output_schema_version: "docjson.v1"
  # prefer grammar mode if your provider supports it; else json_schema
  output_mode: "json_schema"
  output_grammar_ref: "schemas/gbnf/docjson_v1.gbnf"

variables:
  grade: "{{grade}}"
  subject: "{{subject}}"
  chapter: "{{chapter}}"
  standard: "{{standard}}"
  difficulty: "{{difficulty}}"        # one of: comfort | hustle | advanced
  pages_hint: "{{pages_hint}}"        # optional (e.g., "pp. 45–60")

difficulty_policies:
  comfort:
    summary: "stepwise teaching, gentle ramp."
    exposition: "Stepwise, explicit reasoning. No leaps."
    practice: "2–3 worked examples per key idea; basic to mid MCQ/Numerical/A-R."
    extras: "Common pitfalls (units/sign), sanity checks."
    item_mix: { mcq: "4–6", numerical: "4–6", ar: "2–3" }
    blooms: "L1–L3"
  hustle:
    summary: "Include difficult questions + real-world examples; short digressions allowed."
    exposition: "Concise, formula-first; use small real-world mini-cases."
    practice: "Harder practice set; stress parameter tweaks/edge cases."
    extras: "Non-complex digressions to motivate concepts are allowed."
    item_mix: { mcq: "3–5", numerical: "6–8", ar: "2–3" }
    blooms: "L2–L4"
  advanced:
    summary: "Add intuitive diagrams for key formulae; advanced numericals up to IIT-JEE level."
    exposition: "Minimal prose; derivation-heavy where useful."
    practice: "Mode-advanced numericals; multi-step, traps, distractors."
    extras: "Diagrams to explain formulae intuitively; compare methods."
    item_mix: { mcq: "2–4", numerical: "6–10", ar: "3–4" }
    blooms: "L3–L5"

system_prompt: |
  PURPOSE: Generate a chapter as DocJSON (schema: docjson.v1) for {{standard}} {{subject}}, Grade {{grade}}, Chapter "{{chapter}}".
  AUDIENCE: Students preparing for competitive + board exams.
  SOURCE OF TRUTH: Use ONLY the ATTACHED PDF to bound factual content. If pages hint "{{pages_hint}}" is present, scope strictly to it.
  ENHANCEMENT POLICY: Synthesize concise teaching focused on problem-solving; do NOT copy text. You may add practice and insights if CONSISTENT with the PDF scope.
  OUTPUT CONTRACT: Return ONLY DocJSON (no prose). Allowed section types:
    - paragraph
    - equation (TeX + numeric check {expr, vars, expect, tol} + units map if physical)
    - plot (PlotSpec)
    - diagram (DiagramSpec)
    - chem (ChemSpec only if subject == Chemistry)
    - widget (formula-playground)
  DIFFICULTY MODE = {{difficulty}}:
    - Summary: {{difficulty_summary}}
    - Exposition: {{difficulty_exposition}}
    - Practice: {{difficulty_practice}}
    - Extras: {{difficulty_extras}}
    - Item mix (approx counts per 1000 tokens): MCQ {{difficulty_item_mcq}}, Numerical {{difficulty_item_numerical}}, A/R {{difficulty_item_ar}}
    - Bloom targets: {{difficulty_blooms}}
  STYLE: Precise LaTeX; consistent variable names; explicit units.
  SCOPE RULES: If a requested item isn’t supported by the PDF pages, omit it rather than inventing facts.
  FAILURE RULE: Prefer fewer sections over violating scope or schema.

user_prompt: |
  TASK (DocJSON only):
  1) Intro paragraph for "{{chapter}}".
  2) 2–5 equations (each: TeX + numeric check + units map if physical).
  3) Exactly one PlotSpec, one DiagramSpec, one WidgetSpec.
  4) ChemSpec ONLY if subject == "Chemistry".
  5) Respect pages hint "{{pages_hint}}" if provided.

  Return ONLY valid DocJSON per docjson.v1 (no raw TikZ/SVG/HTML).